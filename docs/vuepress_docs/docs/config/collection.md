---
sidebarDepth: 0
---
# Коллекция
***
Описывает все свойства данной коллекции. Данный плагин нужен для описание коллекций - специальных структур данных, которые являются обертками над сырыми таблицами/коллекциями в хранилище данных. У каждого плагина аутентификации и авторизации существует набор коллекций, необходимых для его работы. Соответственно, при их использовании, необходимо также описывать соответствующие коллекции. Плагин не создает сырые таблицы/коллекции в хранилище данных. Он лишь дает Aureole понять, какая сырая таблица/коллекция пригодна для использования в каждом конкретном плагине.
- Тип: **object**. Обязательны: `name`. Наличие дополнительных свойств: **Недопустимо**.
  - `name`: Тип: **string**. Дополнительно: Имя экземпляра плагина. Имя коллекции. Имя используется для того, чтобы в дальнейшем ссылаться на данную коллекцию. Минимальная длина: **1**.
  - `parent`: Тип: **string**. Дополнительно: Ссылка на экземпляр плагина коллекции. Ссылка на родителя коллекции. Некоторые коллекции поддерживают наследование. В БД они ссылаются на одну и ту же таблицу, однако в Aureole они являются одтельными коллекциями, разделяя между собой право получать доступ к тем или иным полям данной таблицы. Минимальная длина: **1**.
  #### Допустим один из вариантов конфига
  ## Identity коллекция.
  - Identity коллекция. Коллекция для хранения данных о пользователе
    - `type`: Константа: **identity**. Тип коллекции. Необходим, чтобы дать Aureole понять, какую из коллекций использовать.
    - `config`: Тип: **object**. Конфигурация коллекции. Описывает все свойства данной коллекции. Обязательны: `name`, `pk`, `fields_map`. Наличие дополнительных свойств: **Недопустимо**.
      - `name`: Тип: **string**. Дополнительно: Имя экземпляра плагина. Имя таблицы в БД. Указывается имя таблицы, с которой будет взаимодействовать данная коллекция. Минимальная длина: **1**.
      - `pk`: Тип: **string**. Ссылка на первичный ключ. Указывается имя поля, которое является первичным ключом таблицы. Имя поля должно быть описано в сопоставлении полей. Минимальная длина: **1**.
      - `fields_map`: Тип: **object**. Сопоставление полей. Перечисление сопоставлений данных с названиями полей в таблице БД. Наличие дополнительных свойств: **Недопустимо**.
        - `id`: Тип: **string**. Сопоставление идентификатора записи. Описывает, как называется поле в таблице БД, которое является идентификатором записи. Минимальная длина: **1**.
        - `username`: Тип: **string**. Сопоставление имени пользователя. Описывает, как называется поле в таблице БД, которое является именем пользователя. Минимальная длина: **1**.
        - `phone`: Тип: **string**. Сопоставление телефона. Описывает, как называется поле в таблице БД, которое является телефоном. Минимальная длина: **1**.
        - `email`: Тип: **string**. Сопоставление электронной почты. Описывает, как называется поле в таблице БД, которое является email-ом. Минимальная длина: **1**.
        - `is_active`: Тип: **string**. Сопоставление флага активного пользователя. Описывает, как называется поле в таблице БД, которое является флагом того, активен ли пользователь или нет. Для явного отключения используется значение 'no'. Минимальная длина: **1**.
        - `created`: Тип: **string**. Сопоставление даты создания пользователя. Описывает, как называется поле в таблице БД, которое является датой создания пользователя. Для явного отключения используется значение 'no'. Минимальная длина: **1**.
        - `email_verified`: Тип: **string**. Сопоставление флага верификации email-а. Описывает, как называется поле в таблице БД, которое является флагом того, верифицировал ли пользователь почту или нет. Для явного отключения используется значение 'no'. Минимальная длина: **1**.
        - `phone_verified`: Тип: **string**. Сопоставление флага верификации телефона. Описывает, как называется поле в таблице БД, которое является флагом того, верифицировал ли пользователь телефон или нет. Для явного отключения используется значение 'no'. Минимальная длина: **1**.
        - `regex(".+")`: Сопоставление дополнительных полей. Описывает, как в таблице БД называются какие-либо дополнительные поля.
          #### Допустим один из вариантов конфига
          ## Краткое описание поля.
          - Тип: **string**. Краткое описание поля. В данном случае указывается только имя поля. Минимальная длина: **1**.
          ## Подробное описание поля.
          - Тип: **object**. Подробное описание поля. В данном случае указываются дополнительные данные о поле. Обязательны: `name`. Наличие дополнительных свойств: **Недопустимо**.
            - `name`: Тип: **string**. Имя поля. Описывает, как называется поле в таблице БД. Минимальная длина: **1**.
            - `type`: Допускаются следующие значения: `boolean`, `int`, `float`, `string`. Тип поля. Описывает, какой тип имеет поле в таблице БД
            - `default`: Значение по-умолчанию. Описывает, какое значение должно устанавливаться по-умолчанию для данного поля.
        #### Допустим любой из вариантов конфига
        - Обязательны: `id`.
        - Обязательны: `username`.
        - Обязательны: `phone`.
        - Обязательны: `email`.
  ## OAuth2 коллекция.
  - OAuth2 коллекция. Коллекция для хранения social auth данных о пользователе.
    - `type`: Константа: **oauth2**. Тип коллекции. Необходим, чтобы дать Aureole понять, какую из коллекций использовать.
    - `config`: Тип: **object**. Конфигурация коллекции. Описывает все свойства данной коллекции. Обязательны: `name`, `pk`, `fields_map`. Наличие дополнительных свойств: **Недопустимо**.
      - `name`: Тип: **string**. Дополнительно: Имя экземпляра плагина. Имя таблицы в БД. Указывается имя таблицы, с которой будет взаимодействовать данная коллекция. Минимальная длина: **1**.
      - `pk`: Тип: **string**. Ссылка на первичный ключ. Указывается имя поля, которое является первичным ключом таблицы. Имя поля должно быть описано в сопоставлении полей. Минимальная длина: **1**.
      - `fields_map`: Тип: **object**. Сопоставление полей. Перечисление сопоставлений данных с названиями полей в таблице БД. Обязательны: `id`, `social_id`, `email`, `provider`, `user_data`, `user_id`. Наличие дополнительных свойств: **Недопустимо**.
        - `id`: Тип: **string**. Сопоставление идентификатора записи. Описывает, как называется поле в таблице БД, которое является идентификатором записи. Минимальная длина: **1**.
        - `social_id`: Тип: **string**. Сопоставление идентификатора пользователя. Описывает, как поле, которое хранит идентификатора пользователя в сети провайдера, называется в БД. Минимальная длина: **1**.
        - `email`: Тип: **string**. Сопоставление email-а. Описывает, как поле, которое хранит электронную почту, называется в БД. Минимальная длина: **1**.
        - `provider`: Тип: **string**. Сопоставление имени провайдера. Описывает, как поле, которое хранит имя провайдера, называется в БД. Минимальная длина: **1**.
        - `user_data`: Тип: **string**. Сопоставление пользовательских данных. Описывает, как поле, которое хранит все данные, которые прислал провайдер, называется в БД. Минимальная длина: **1**.
        - `user_id`: Тип: **string**. Сопоставление ссылки на пользователя. Описывает, как поле, которое хранит ссылку на пользователя в внутренней БД, называется в БД. Минимальная длина: **1**.
  - См. [PwbasedCollection](./authn.md#pwbasedcollection).
  - См. [SessionCollection](./authz.md#sessioncollection).
  - См. [PhoneOtpCollection](./authn.md#phoneotpcollection).
  - См. [PasswordResetCollection](./authn.md#passwordresetcollection).
  - См. [EmailLinkCollection](./authn.md#emaillinkcollection).
  - См. [EmailVerificationCollection](./authn.md#emailverificationcollection).
  ### Пример конфига
  ```yaml
  collections:
    - type: "identity" # main collection
      name: identity
      config:
        name: "users"
        pk: "id"
        fields_map:
          id: "id"
          username: "username"
          phone: "phone"
          email: "email"
          is_active: no
          created: "created"
          email_verified: "email_verified"
          phone_verified: "phone_verified"
          is_superuser:
            name: "is_superuser"
            type: boolean
            default: false
          is_staff:
            name: "is_staff"
            type: boolean
            default: false
  
    - type: "pwbased" # appendix collection
      name: pwbased
      parent: identity
      config:
        fields_map:
          password: "password"
  ```
